# 2024-03-11

## LLM tree search

I read something about using tree search to get better output from LLMs. I don't know what the other
person's plan was, but I'd like to have a play. My plan is instead of taking (for example) the highest-probability
token at each point, and then building a straight line like that, we'd take the N highest-probability "root" words,
and recurse for M levels, and at the end of the M levels we'd work out which string has the highest probability
overall, and output the root word that leads into that subtree, throw away all the other subtrees,
evaluate the N highest-probability leaf words for the chosen subtree, choose the new root word that leads to
the highest probability string, etc.

So after you've spun up the initial tree, generating a single token takes **O(M^N)** times as much work as before,
i.e. you need to evaluate a new set of leaf nodes each time. My guess is you'd want to make M high and N small.
Perhaps you'd even want to make N vary (i.e. try all the most likely tokens that add up to a probability in
excess of some value, instead of always taking the same number of tokens).

Using Karpathy's Python GPT tutorial implementation, trained on my blog, before was:

    co a rett
    Qns no os a the 2 I it ror
    wany cogen Thake ond she the measter a theas ungh mid ssacke leer mit't theat repttitidin sopeps tasit i ammoukeg enalr shim ofocks star efortwirig sthict tlend 20 yof dout sto prame. Is the we me ein fuatin of wire and Azeck rind Moveach cropps stoace stis forer ass poarinti4#in0%ar</p6><Cov>pth_ tobe thes vere on neee julure MOY "pes mar1% prouid. ":
    6700 al with thant om soy the thao cake sros ime <le

After, with N=2, M=6:

    <r>_Iff="htorchtp eveitedsed I seateses. Thadgey she mistroses and to uto evesse ins to ide to menking withth is me the froas the to seter to hocore, end if tor se is the Be <a aref="htps://gitorend cacht af thing in s laklle at ant is that st's in soplilaced is en thasks thie
    ind to thave the sebopot intide. The htho mine a
    to thand lockige hefor" ind and tho tit heat he aves "taitare
    sile ore laten</e>

    <a href="hto the the the ome swo abl it prighing of the an I bit tholly owen with lis ther

Not obvious that there's much improvement.
